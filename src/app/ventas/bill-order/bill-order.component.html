<div class="container container-fluid">
    <h3>Órdenes de Venta</h3>
    <br>
    <input type="text" class="form-control col-md-12" name="filterCustomer" placeholder="Buscar órdenes por Cliente..." [(ngModel)]="filterCustomer">
    <br>
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col">#</th>
                <th scope="col">Fecha</th>
                <th scope="col">Cliente</th>
                <th scope="col">Usuario Creador</th>
                <th scope="col">Total</th>
                <th scope="col"></th>
            </tr>
        </thead>       
        <tbody>
            <tr *ngFor="let order of saleOrder | filterOrderByCustomer: filterCustomer ">
                <td><input id="radio" name="order" type="radio" value="selectedOrder"(change)="onSelectionChange(order)" /></td>
                <th scope="row"> {{ order.id }} </th>
                <td>{{ order.createdDate }}</td>
                <td>{{ order.customer.lastName }}, {{ order.customer.name }}</td>
                <td>{{ order.user.userName }}</td>
                <td>{{ order.totalAmount }} </td>
                <td> 
                    <button class="btn btn-danger" (click)="eliminar(order.id)">Cancelar</button>
                </td>
        </tbody>
    </table>
</div>
<br>
<br>
<br>
<h3 *ngIf="selectedOrder.id != null" >Vista Previa de Factura</h3>
<br>
<div id="invoice" *ngIf="selectedOrder.id != null" class="card">
    <div class="card-body">
      <div class="container mb-5 mt-3">
        <div class="row d-flex align-items-baseline">
          <div class="col-xl-9">
            <p style="color: #7e8d9f;font-size: 20px;">Factura <strong>No #: {{ bill.id }}</strong></p>
          </div>
        </div>
        <div class="container">
          <div class="col-md-12">
            <div class="text-center">
              <i class="fab fa-mdb fa-4x ms-0" style="color:#5d9fc5 ;"></i>
              <h2 class="pt-0">C</h2>
            </div>
          </div>
          <div class="row">
            <div class="col-xl-8">
              <ul class="list-unstyled">
                <li class="text-muted">To: <span style="color:#5d9fc5 ;">
                    {{ preview.customer?.lastName }}, {{ preview.customer?.name}}</span></li>
                <li class="text-muted"> {{selectedOrder.customer.address }} </li>
                <li class="text-muted"> Argentina</li>
              </ul>
            </div>
            <div class="col-xl-4">
              <p class="text-muted">  <h3> FARMAVIP </h3>
              <ul class="list-unstyled">
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="fw-bold">No #:</span> {{ bill.id }} </li>
                <li class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="fw-bold">Fecha: </span> {{ preview.createdDate }} </li>
                <li *ngIf="bill.id != null" class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                      class="me-1 fw-bold">Status:</span><span class="badge bg-info text-black fw-bold">
                      Pagado</span></li>
                <li *ngIf="bill.id == null" class="text-muted"><i class="fas fa-circle" style="color:#84B0CA ;"></i> <span
                    class="me-1 fw-bold">Status:</span><span class="badge bg-warning text-black fw-bold">
                    Pendiente Pago</span></li>
              </ul>
            </div>
          </div>
  
          <div class="row my-2 mx-1 justify-content-center">
            <table class="table table-striped table-borderless">
              <thead style="background-color:#84B0CA ;" class="text-white">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Producto</th>
                  <th scope="col">Cantidad</th>
                  <th scope="col">Precio Unitario</th>
                  <th scope="col">Descuento</th>
                  <th scope="col">Total</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of preview.items">
                  <th scope="row"> {{item.id}}  </th>
                  <td> {{item.offer?.product?.name}} </td>
                  <td> {{item.quantity}} </td>
                  <td> {{item.unitaryPrice}} </td>
                  <td> {{item.discountAmount}} </td>
                  <td> {{item.totalPrice}} </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="row">
            <div class="col-xl-8">
            </div>
            <div class="col-xl-3">
              <ul class="list-unstyled">
                <li class="text-muted ms-3"><span class="text-black me-4">SubTotal</span> $ {{preview.totalAmount}} </li>
                <li class="text-muted ms-3 mt-2"><span class="text-black me-4">Descuento </span>$ 0</li>
              </ul>
              <p class="text-black float-start"><span class="text-black me-3"> Total: </span><span
                  style="font-size: 25px;">$ {{preview.totalAmount}} </span></p>
            </div>
            <div>
                Codigo de Autorizacion Electronico: {{ preview.cae }}
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-xl-10">
              <p>Gracias por su compra !!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div *ngIf="selectedOrder.id != null" >
    <h5>Elija Forma de Pago: </h5>
    <br>
    <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="a" [(ngModel)]="apply">
    <label class="form-check-label" for="exampleRadios1">
    Efectivo
    </label>
  <br>
  <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="b"  [(ngModel)]="apply">
    <label class="form-check-label" for="exampleRadios2">
    Tarjeta de Credito
    </label>
  <br>
  <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios3" value="c"  [(ngModel)]="apply">
    <label class="form-check-label" for="exampleRadios3">
    Tarjeta de Debito
    </label>
  </div>
   <br>
   <br>
  <div *ngIf="selectedOrder.id != null">
    <button *ngIf="bill.id == null" type="button" class="btn btn-primary text-capitalize" (click)="facturar()" [disabled]="!apply" >Facturar</button>
    <button *ngIf="bill.id != null" type="button" class="btn btn-primary text-capitalize" (click)="pdf()">Descargar Factura</button>
    <button type="button" class="btn btn-danger text-capitalize" (click)="cancelar()">Cancelar</button>
  </div>
